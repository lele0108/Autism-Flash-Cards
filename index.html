<!DOCTYPE html> 
<html> 
<head> 
	<title>Familee</title> 
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" type="text/css" href="css/jquery.mobile.flatui.css" />
	<link href="css/main.css" rel="stylesheet" media="screen">
	<script src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
	<script src="js/custom.js"></script>
	<script src="http://code.jquery.com/mobile/1.2.1/jquery.mobile-1.2.1.min.js"></script>
<script src="https://cdn.firebase.com/v0/firebase.js"></script>
<script type="text/javascript" src="//api.filepicker.io/v1/filepicker.js"></script>

<script>
	var count = 'design';
	var img = "";
    filepicker.setKey('ASoEnOMQ8KbcdDzfxUrUQz');

function add()
{
    var firebaseRef = new Firebase('https://studyroom.firebaseio.com/');
    var newUser = firebaseRef.push();
    firebaseRef = new Firebase ('https://studyroom.firebaseio.com/'+newUser.name());

    //console.log($("#name").val());
    console.log(img);
    if(img == "")
        img = "https://www.filepicker.io/api/file/2Ge3dw1QsmAkoVusJEXI";
    alert("DDD" + img)
    firebaseRef.push({name:$("#name").val(), about:$("#about").val(), relation:$("#relation").val() , img:img , phone:$('#phone').val() });
    //alert(img);
    $("#nameSlide").html($("#name").val());
    $("#imgSlide").html('<img src="http://extrametrics.com/facedetect/?image='+img+'" width="250" height="250">');
    //firebaseRef.push({img:img});
    window.location.assign("#four");
}

function readIn()
{
	var firebaseRefName = new Firebase('https://studyroom.firebaseio.com/name');
	var firebaseRefAbout = new Firebase('https://studyroom.firebaseio.com/about');
	var firebaseRefRelation = new Firebase('https://studyroom.firebaseio.com/relation');
	var firebaseRefImage = new Firebase('https://studyroom.firebaseio.com/img');
	var firebaseRefPhone = new Firebase('https://studyroom.firebaseio.com/phone');
	firebaseRefName.on('value', function(snapshot) {
	  $("#nameSlide").html(snapshot.val());
	});
	firebaseRefAbout.on('value', function(snapshot) {
	  $("#aboutSlide").html(snapshot.val());
	});
	firebaseRefRelation.on('value', function(snapshot) {
	  $("#relationSlide").html(snapshot.val());
	});
	firebaseRefImage.on('value', function(snapshot) {
	  img = snapshot.val();
	  $("#imgSlide").html('<img src="http://extrametrics.com/facedetect/?image='+img+'" width="250" height="250">');
	});
	firebaseRefPhone.on('value', function(snapshot) {
	  $("#phoneSlide").html(snapshot.val());
	});
}

readIn();
</script>
<script type='text/javascript'>
$(window).load(function(){
$('#go').click(function() {
    var page1 = $('.page1');
    var page2 = $('.page2');
    var toHide = page1.is(':visible') ? page1 : page2;
    var toShow = page2.is(':visible') ? page1 : page2;
    
    toHide.removeClass('flip in').addClass('flip out').hide();
    toShow.removeClass('flip out').addClass('flip in').show();
});
});
</script>

<script type='text/javascript'>
$('.container').live('vclick',function(event) {
    var page1 = $('.page1');
    var page2 = $('.page2');
    var toHide = page1.is(':visible') ? page1 : page2;
    var toShow = page2.is(':visible') ? page1 : page2;
    
    toHide.removeClass('flip in').addClass('flip out').hide();
    toShow.removeClass('flip out').addClass('flip in').show();
});
</script>

</head> 
<body>

<div data-role="page" id="one">
	<div data-role="header">
		<h1>Familee</h1>
	</div><!-- /header -->
	<div data-role="content">
		<div class="title">
		<center><h1>Get to know your family better!<br>Build a family tree!</h1></center><br><br>
		<a href="#two" data-transition="slide" data-role="button" data-theme="c">Create</a>
		<a href="#three" data-transition="slide" data-role="button" data-theme="c">View</a>
		</div>
	</div><!-- /content -->
	<div data-role="footer"> 
		<h4>Built for AT&T Hackathon. Copyright 2013</h4> 
	</div> 
</div><!-- /page  one-->

<div data-role="page" id="two">

	<div data-role="header">
		<h1>Familee</h1>
	</div><!-- /header -->

	<div data-role="content">
		<div class="title">
		<center><h1>Upload your images</h1></center><br><br>

        <input type="text" class="input-xlarge" id="name"  class="span8" placeholder="Name:">
        <input type="text" class="input-xlarge" id="phone" class="span8" placeholder="Phone Number:">
            
        <select id = "relation">
          <option>What is the relation?</option>
          <option value="family">Family</option>
          <option value="friend">Friend</option>
          <option value="pet">Pet</option>
        </select>
            
            <textarea class="field span8" id="about" rows="3" placeholder="Who is this person?"></textarea>
            <input type="filepicker" class="btn" data-role="button"  onchange="img = event.fpfile.url; alert(img); add();" data-fp-services="WEBCAM,COMPUTER"/>
		    <a href="#one" data-transition="slide" data-rel="back" data-role="button">Go Back</a>
        
		</div>
	</div><!-- /content -->

	<div data-role="footer"> 
		<h4>Built for AT&T Hackathon. Copyright 2013</h4> 
	</div> 

</div><!-- /page two-->

<div data-role="page" id="three">

	<div data-role="header">
		<h1>Familee</h1>
	</div><!-- /header -->

	<div data-role="content">
		<div class="title">
		<center><h1>Images are ready. Let's play!</h1></center><br><br>
		<a href="#four" data-transition="slide" data-role="button">Play Now</a>
		</div>
	</div><!-- /content -->

	<div data-role="footer"> 
		<h4>Made for AT&T Hackathon. Copyright 2013</h4> 
	</div> 

</div><!-- /page three-->

<div data-role="page" id="four">

	<div data-role="header">
		<h1>Familee</h1>
	</div><!-- /header -->

	<div data-role="content">
		<div class="title">
		<center><h1><div id="nameSlide"></div></h1></center><br><br>

		<div class="container">
	    <div class="page1">
				<p>This is a Sample FlashCard</p>
				<img src="http://placehold.it/50x50">
	    </div>
	    <div class="page2">
				<p>This is a Sample FlashCard 2</p>
				<img src="http://placehold.it/50x50">
	    </div>
		</div>

		<button type="button" id="go">Flip</button>
		<a href="#three" data-transition="slide" data-rel="back" data-role="button">Go Back</a>
		</div>
	</div><!-- /content -->

	<div data-role="footer"> 
		<h4>Made for AT&T Hackathon. Copyright 2013</h4> 
	</div> 

</div><!-- /page four-->

<div data-role="page" id="six">

	<div data-role="header">
		<h1>Familee</h1>
	</div><!-- /header -->
    <script>
    var firebaseRef = new Firebase('https://studyroom.firebaseio.com/');
    var counter = 0;
    firebaseRef.on('child_added', function(snapshot) {
        var user = snapshot.ref();
        console.log(user);
        user.on('child_added', function(othersnapshot) {
            var data = othersnapshot.val();
            console.log(data);
            data.name;
            data.phone;
            data.img;
            data.about;
           $("#list").append('<div class="span2" ><a href = "#modal'+counter+'" data-toggle = "modal"><img class="person"  id="p1" src="'+data.img+'/convert?align=faces&crop=0,0,1000,1000" height="150" width="150"></a/></div><div id="modal'+counter+'" class="modal hide fade in"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button><h3>'+data.name+'</h3></div><div class="modal-body"><p>'+data.about+'</p></div></div>');
           var temp  = "#p" + counter;
            counter++;            
        });
    });
    </script>

	<div data-role="content">
		<div class="title">
		<div id = "list">
            
        </div>
        </div>
	</div><!-- /content -->

	<div data-role="footer"> 
		<h4>Made for AT&T Hackathon. Copyright 2013</h4> 
	</div> 

</div><!-- /page five-->




</body>
</html>